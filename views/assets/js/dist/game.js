!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){class n{constructor(t,e,n,i){this.x=t,this.y=e,this.width=2,this.height=10}move(t){}requestMove(){}isColliding(t){return t.x<this.x+this.width&&t.x>this.x-this.width&&t.y<this.y+this.height&&t.y>this.y}}class i{constructor(t,e,n){this.x=t,this.y=e,this.width=1,this.height=2,this.velocity=n}move(t){this.x+=this.velocity.x*t,this.y+=this.velocity.y*t}collideWithBricks(t){for(const e of t)if(e.isColliding(this))return e;return null}collideWithXWalls(){return this.x<=0||this.x>=100}collideWithYWalls(){return this.y<=0||this.y>=100}}t.exports={Pong:class{constructor(){this.bricks=[new n(10,50),new n(90,50)],this.balls=[new i(50,50,{x:2,y:2*Math.random()-1})],this.currentFrame=0}processFrame(t=1){for(const e of this.balls)(e.collideWithBricks(this.bricks)||e.collideWithXWalls())&&(e.velocity.x=-e.velocity.x),e.collideWithYWalls()&&(e.velocity.y=-e.velocity.y),e.move(t);this.currentFrame+=t}processEvent(t){for(let e of this.bricks)if(e.x<50){let n=0;for(let e of t.left)"u"==e&&(n-=1),"d"==e&&(n+=1);e.y+=n}else{let n=0;for(let e of t.right)"u"==e&&(n-=1),"d"==e&&(n+=1);e.y+=n}}synchronize(t){if(t.frame>=this.currentFrame){this.bricks=[];for(let e of t.bricks)this.bricks.push(new n(e.x,e.y));this.balls=[];for(let e of t.balls)this.balls.push(new i(e.x,e.y,e.velocity));this.currentFrame=t.frame}return this.currentFrame-t.frame}getSynchronisation(){return{bricks:this.bricks,balls:this.balls,frame:this.currentFrame}}}}},function(t,e,n){"use strict";n.r(e);const i=1;function r(t){a.ctx.fillStyle=t}function o(t,e,n,r){a.ctx.fillRect(t*i*a.width/100|0,e*i*a.height/100|0,n*i*a.width/100|0,r*i*a.height/100|0)}var s=n(0);n.d(e,"Context",function(){return a}),n.d(e,"player",function(){return l}),n.d(e,"journal",function(){return k});const c=10;let l,h,a={ctx:null,canvas:null,width:null,height:null,frameCount:null,fps:null,deltaTime:null};const u=20;let d,f,y,m=[],v=[],w=!0;function g(t){(h=new s.Pong).synchronize(t),setInterval(()=>{!function(t){f.emit("playerInfo",t)}(v),v=[]},100),k("initialisation done"),w=!1}function p(){a.ctx.clearRect(0,0,a.canvas.width,a.canvas.height),w||(d>0?d--:h.processFrame(a.deltaTime),function(t){for(const e of t.bricks)"left"==l.side&&e.x<50?r("red"):"right"==l.side&&e.x>50?r("red"):r("white"),o(e.x,e.y,e.width,e.height);for(const e of t.balls)r("white"),o(e.x,e.y,e.width,e.height)}(h)),a.fps=function(){let t=performance.now(),e=t-y;return y=t,1/e*1e3}(),a.deltaTime=c/a.fps,a.frameCount++,requestAnimationFrame(p)}function x(){a.canvas=document.getElementById("game"),a.ctx=a.canvas.getContext("2d"),a.frameCount=0,window.onresize=b,window.onkeydown=(t=>(function(t){40==t.keyCode&&v.push("d");38==t.keyCode&&v.push("u")})(t)),window.onkeyup=(t=>void 0),a.canvas.addEventListener("contextmenu",t=>t.preventDefault()),a.width=a.canvas.width=window.innerWidth-100,a.height=a.canvas.height=window.innerHeight-100,b()}function b(){a.width=a.canvas.width=window.innerWidth,setTimeout(()=>{a.height=a.canvas.height=window.innerHeight},0)}function k(t){m.push({date:new Date,message:t}),m.length>u&&m.shift()}document.addEventListener("DOMContentLoaded",function(){var t;x(),f=io(),t=(t=>{l=t.player,g(t.pong)}),f.on("connected",e=>{k("connected to server on "+e.side+" side"),t(e)}),f.on("disconnect",()=>{k("disconnected from server"),w=!0}),f.on("gameInformations",t=>{h.processEvent(t)}),f.on("gameSynchronisation",t=>{d=h.synchronize(t)}),p()})}]);